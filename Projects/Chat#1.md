# #1. 커플 채팅 서비스 개발
# project couple-chat

---

## 개요

블로그 프로젝트가 마무리되고, 다음 프로젝트로 커플 전용 채팅 서비스를 개발하기로 했다. 

---

## 개발이유

기존 커플 메신저 어플리케이션 중 연인의 현재 위치를 확인할 수 있는 기능이 있는 어플리케이션이 있다.

상대방의 화면이 켜져있는지, 현재 위치가 어딘지부터 시작해서 상대방의 통화, 메세지 내역을 확인할 수 있게 해주는 커플 앱도 등장했다. 신뢰는 연인간의 중요한 문제다. 이러한 기능들은 일시적으로는 불안감을 해소시킬 수 있지만 길게본다면 커플 어플리케이션의 목적과 반대로 오히려 연인간의 신뢰를 무너뜨리게 될 수 있다. 연인 간 서로를 믿지 못해 감시/확인하기 위한 기능들보다 서로를 더 믿을 수 있게 돕기위한 기능들이 더 필요해보였다.

또 내 주변 친한 지인들의 반 정도는 연애를 하고있다. 실제 주변의 커플들을 대상으로 이 서비스를 사용하도록해서 운영 상 개선점을 확인할 수 있겠다는 생각을 했다. 내가 직접 사용할 수 있으면 좋겠지만 나와 이 서비스를 사용할 사람이 없다..

신뢰를 쌓는 방법에 대해 알아보았다.

---

## 신뢰를 쌓는 3가지 원칙

### 자기 이해

나는 어떤 사람인지, 내가 무엇을 중요하게 여기는지 파악하는 것

### 상대방 이해

상대는 무엇을 좋아하고 싫어하는지 상대의 가치관을 파악하는 것

### 상호 이해

내 가치관과 상대의 가치관 모두 중요하다는 것을 이해하는 것

---

이 원칙을 바탕으로 핵심기능과 요구사항을 분석했다.

---

## 핵심기능

1. 최근 1주일동안 채팅에서 많이 사용된 단어 순위를 제공하는 기능

자신과 상대방이 어떤 말을 자주 하는지 확인함으로써, 상대방에 대한 스스로의 태도를 점검하거나 관계의 현상을 가시적으로 확인할 수 있다.

\+ 사용자는 3, 5, 10순위 중 선택해서 몇 순위까지 확인할 지 결정할 수 있다.

\+ 의미없는 단어들(아, 음, 앗 등)은 사용자가 지정해서 단어 순위에서 제외시킬 수 있고, 제외된 단어를 취소할 수도 있다.

   
2. 채팅 중 특정 단어가 나오면 해당 단어에 대한 질문이 팝업되고, 해당 질문에 대해 서로 답변하도록 하는 기능

질문들을 통해 자신과 상대방에 대해 더 알아가게 되고, 이를 바탕으로 더 깊은 관계로 이어지도록 유도할 수 있다.

> ex) '음식'이라는 단어가 채팅 중 나오면 "못먹는 음식이 무엇인지" 에 대한 질문이 채팅창에 팝업되고, 각 사용자는 이 질문에 대답해야 채팅을 이어갈 수 있다.

\+ 그 동안 진행했던 질문과 대답을 정리해서 볼 수 있게 해주는 기능

1. D-DAY를 설정/삭제할 수 있는 기능

약속을 잘 지키는 것은 신뢰를 쌓는데 중요한 요소이다.

4. 연인 간 커넥션을 끊을 때(이별) 바로 연결이 끊기지 않고 7일의 유예기간을 두어서 커넥션 해제를 취소할 수 있게 하는 기능

한 번의 이별 선언은 되돌아오지 못하는 강을 건너는 것과 같다. 바로 연결이 끊어지지 않고 7일간 언제든지 커넥션 해제를 취소할 수 있게한다.

\+ 7일이 지난 이후에는 자동으로 상대방과의 연결이 종료된다.

---

## 요구사항 분석

* 여러 커플들이 서비스를 이용해도 커넥션(연인)간 간섭이 없어야 한다.

* 회원가입, 회원탈퇴, 로그인, 로그아웃, 비밀번호 변경, 비밀번호 찾기 기능을 제공해야한다.

* ~~비밀번호 찾기 기능은 이메일 API를 통해 인증번호를 받아 변경하는 방식으로 구현하려했으나 네이버 이메일 API가 유료라 구현 불가~~

* 사용자끼리 커넥션 신청/승인/삭제/취소/해제 기능을 제공해야한다.

* 실시간 채팅 기능을 제공해야한다.

* 웹소켓을 이용한 실시간 채팅이 가능해야한다.

* 채팅 전송 시간이 표시되어야한다.

* 채팅으로 영상/사진 등 파일 전송이 가능해야한다.

* 이미지파일 전송 시 채팅에 썸네일 표시가 되어야한다.

* 단어 기반 채팅 검색이 가능해야한다.

* 날짜 기반 채팅 검색이 가능해야한다.

* 내가 보낸 채팅만 삭제할 수 있어야한다.
  
* ~~실시간 채팅 전송시 상대방이 웹소켓 연결되어있지 않은 상태면 푸시알림을 통해 모바일 알람을 전송하는 기능은 ADP가 유료라 구현 불가~~

* 일정 등록/삭제가 가능한 캘린더 기능이 있어야한다.

* D-Day 설정 및 날짜계산이 가능해야한다.
  
* 전월/이월로 캘린더 이동이 가능해야한다.

* 버튼을 통해 현재 달로 캘린더 이동이 가능해야한다.

* 캘린더에 당일을 표시하는 기능이 있어야한다.

---

## 이번 프로젝트에서 새롭게 도입할 기술

1. Terraform을 활용한 인프라스트럭처 프로비저닝
2. Kubeadm과 Containerd를 활용한 쿠버네티스 클러스터 프로비저닝
3. Kubernetes를 활용한 어플리케이션 배포
4. Backend에 MVC패턴 적용
5. Backend Directory에 Go 컨벤션 적용
6. Gorilla Websocket 활용한 실시간 채팅
7. 환경변수 설정을 통한 보안 강화

---

## 참고

[신뢰를 쌓는 세 가지 원칙](https://post.naver.com/viewer/postView.nhn?volumeNo=30365635&memberNo=253010)